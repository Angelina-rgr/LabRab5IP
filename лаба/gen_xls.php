<?require_once('PHPExcel/Classes/PHPExcel.php');require_once('PHPExcel/Classes/PHPExcel/Writer/Excel5.php');$xls = new PHPExcel();$xls->setActiveSheetIndex(0);$sheet = $xls->getActiveSheet();$servername = "localhost";$database = "f0478659_cars";$username = "f0478659_root";$password = "123";$connection = mysqli_connect($servername, $username, $password, $database);if (!$connection) {die("Connection failed: " . mysqli_connect_error());}$sheet->setTitle('Машины в наличии');$sheet->getColumnDimension('E')->setWidth(15);$sheet->getColumnDimension('D')->setWidth(8);$sheet->getColumnDimension('G')->setWidth(15);$sheet->getColumnDimension('H')->setWidth(15);$zagolovok =array("Номер","Марка","Модель", "Год выпуска", "Трансмиссия", "Цена","Магазин","Адрес");for($i = 0;$i<count($zagolovok);$i++)$sheet->setCellValueByColumnAndRow($i,1,$zagolovok[$i]);$result = mysqli_query($connection, "SELECT `auto_nalich`.`id`,`auto_nalich`.`id_car`,`auto_nalich`.`id_salon`,`auto_nalich`.`cost`,`mashina`.`name`,`mashina`.`model`,`mashina`.`year`, `mashina`.`trans`,`autosalon`.`address`,`autosalon`.`name_salon` FROM `auto_nalich`LEFT JOIN `mashina`ON `auto_nalich`.`id_car`=`mashina`.`id_car`LEFT JOIN `autosalon`ON `auto_nalich`.`id_salon`=`autosalon`.`id_salon`");$i=2;while($row = mysqli_fetch_array($result)){$sheet->setCellValueByColumnAndRow(0,$i,$row['id']);$sheet->setCellValueByColumnAndRow(1,$i,$row['name']);$sheet->setCellValueByColumnAndRow(2,$i,$row['model']);$sheet->setCellValueByColumnAndRow(3,$i,$row['year']);$sheet->setCellValueByColumnAndRow(4,$i,$row['trans']);$sheet->setCellValueByColumnAndRow(5,$i,$row['cost']);$sheet->setCellValueByColumnAndRow(6,$i,$row['name_salon']);$sheet->setCellValueByColumnAndRow(7,$i,$row['address']);$i++;}// Выводим HTTP-заголовкиheader ( "Expires: Mon, 1 Apr 1974 05:00:00 GMT" );header ( "Last-Modified: " . gmdate("D,d M YH:i:s") . " GMT" );header ( "Cache-Control: no-cache, must-revalidate" );header ( "Pragma: no-cache" );header ( "Content-type: application/vnd.ms-excel" );header ( "Content-Disposition: attachment; filename=Cars.xls" );// Выводим содержимое файла$objWriter = new PHPExcel_Writer_Excel5($xls);$objWriter->save('php://output');?>